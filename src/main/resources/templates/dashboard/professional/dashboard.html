<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assessment Results - MindCare</title>
    <link rel="stylesheet" th:href="@{/css/variables.css}">
    <link rel="stylesheet" th:href="@{/css/dashboard/professional/dashboard.css}">
</head>
<body>
    <!-- Navigation Bar -->
    <div th:replace="~{fragments/navbar :: navbar('dashboard')}"></div>

    <!-- Main Content -->
    <div class="container">
        <div class="welcome-message--container">
            <h2>Welcome, Dr.<span th:text="${username}">Moaz</span></h2>
            <p>You have 3 sessions scheduled for today</p>
        </div>

        <div class="quick-actions--container">
            <a  th:each="action : ${quickActions}"
                th:href="@{${action.url}}"
                class="quick-action--card"
            >
                <span class="action-icon">
                    <th:block
                        th:replace="~{fragments/icons :: __${action.icon}__}">
                    </th:block>
                </span>
                <p th:text="${action.label}">Label</p>
            </a>
        </div>
        
        <main class="dashboard--container">
            <div class="dashboard--left">
                <div class="card schedule--container">
                    <div class="card--header">
                        <div class="card-title">
                            <span class="card-icon">
                                <th:block
                                    th:replace="~{fragments/icons ::icon-calendar}">
                                </th:block>
                            </span>
                            <span class="title-text">Today's Schedule</span>
                        </div>
                        <p>Sunday, November 2, 2025</p>
                    </div>
                    <div class="schedule-items--container">
                        <div class="schedule-item" th:each="scheduledSession : ${todaysSchedule}">
                            <div class="schedule-info">
                                <span th:text="${scheduledSession.studentName}">Student Name</span>

                                <span class="gray-text">
                                    <span th:text="${#temporals.format(scheduledSession.date, 'h:mm a')}">10:00 AM</span> • 
                                    <span th:text="${scheduledSession.type}">Individual</span>
                                </span>
                            </div>

                            <div class="schedule-item--actions">
                                <span class="status-pill" 
                                    th:classappend="${#strings.toLowerCase(scheduledSession.status)}" 
                                    th:text="${scheduledSession.status}">
                                    Confirmed
                                </span>

                                <button class="btn btn-secondary view--btn"
                                        onclick="openModal(this)"
                                        th:data-student="${scheduledSession.studentName}"
                                        th:data-time="${#temporals.format(scheduledSession.date, 'h:mm a')}"
                                        th:data-email="${scheduledSession.studentEmail}"
                                        th:data-phone="${scheduledSession.studentPhone}"
                                        th:data-type="${scheduledSession.type}"
                                        th:data-status="${scheduledSession.status}"
                                        th:data-reason="${scheduledSession.reason}"
                                        th:data-notes="${scheduledSession.notes}">
                                    View
                                </button>
                            </div>
                        </div>

                        <div th:if="${#lists.isEmpty(todaysSchedule)}" style="text-align: center; padding: 1rem;">
                            <p class="gray-text">No sessions scheduled for today.</p>
                        </div>

                        <button class="btn btn-primary" style="margin-top: 1rem;">Manage Schedule</button>
                    </div>
                </div>

                <div class="card recent-consultations--container">
                    <div class="card--header">
                        <div class="card-title">
                            <span class="card-icon">
                                <th:block
                                    th:replace="~{fragments/icons ::icon-people}">
                                </th:block>
                            </span>
                            <span class="title-text">Recent Students</span>
                        </div>
                        <p>Overview of recent consultations</p>
                    </div>
                    <div class="recent-items--container">
                        <div class="recent--item">
                            <div class="item-info">
                                <span>Alex M.</span>
                                <span class="gray-text">Last session: Nov 1, 2025</span>
                            </div>
                            <div class="item-status">
                                <span class="gray-text">Improving</span>
                                <span class="item-icon">
                                    <svg th:replace="~{fragments/icons ::icon-trend}"></svg>
                                </span>
                            </div>
                        </div>

                        <div class="recent--item">
                            <div class="item-info">
                                <span>Jordan P.</span>
                                <span class="gray-text">Last session: Oct 28, 2025</span>
                            </div>
                            <div class="item-status">
                                <span class="gray-text">Stable</span>
                                <span class="item-icon light-purple">
                                    <svg th:replace="~{fragments/icons ::icon-trend}"></svg>
                                </span>
                            </div>
                        </div>

                        <div class="recent--item">
                            <div class="item-info">
                                <span>Sam K.</span>
                                <span class="gray-text">Last session: Oct 26, 2025</span>
                            </div>
                            <div class="item-status light-purple">
                                <span class="gray-text">Needs Attention</span>
                                <span class="item-icon red">
                                    <svg th:replace="~{fragments/icons ::icon-trend}"></svg>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard--right">
                <div class="card summary--container">
                    <div class="card--header">
                        <div class="card-title">
                            <span class="card-icon">
                                <th:block
                                    th:replace="~{fragments/icons ::icon-bell}">
                                </th:block>
                            </span>
                            <span class="title-text">Summary</span>
                        </div>
                        <p>Your weekly overview</p>
                    </div>
                    <div class="summary-items--container">
                        <div class="summary-item">
                            <span class="summary-icon">
                                <svg th:replace="~{fragments/icons ::icon-calendar}"></svg>
                            </span>
                            <div class="summary-text">
                                <span class="gray-text">Total Sessions This Week</span>
                                <span>12</span>
                            </div>
                        </div>

                        <div class="summary-item">
                            <span class="summary-icon">
                                <svg th:replace="~{fragments/icons ::icon-people}"></svg>
                            </span>
                            <div class="summary-text">
                                <span class="gray-text">Active Students</span>
                                <span>12</span>
                            </div>
                        </div>

                        <div class="summary-item">
                            <span class="summary-icon">
                                <svg th:replace="~{fragments/icons ::icon-clock}"></svg>
                            </span>
                            <div class="summary-text">
                                <span class="gray-text">Pending Requests</span>
                                <span>1</span>
                            </div>
                        </div>

                        <div class="summary-item">
                            <span class="summary-icon">
                                <svg th:replace="~{fragments/icons ::icon-book}"></svg>
                            </span>
                            <div class="summary-text">
                                <span class="gray-text">Resources Published</span>
                                <span>15</span>
                            </div>
                        </div>

                    </div>                            
                </div>
                
                <div class="card requests--container">
                    <div class="card--header">
                        <div class="card-title">
                            <span class="card-icon">
                                <th:block
                                    th:replace="~{fragments/icons ::icon-clock}">
                                </th:block>
                            </span>
                            <span class="title-text">Pending Requests</span>
                        </div>
                    </div>

                    <div class="requests-items--container">
                        <div class="request--item">
                            <div class="request--info">
                                Jamie L.
                                <span class="gray-text">Dec 25, 3:00 PM</span>
                            </div>
                            <div class="request--actions">
                                <button class="btn btn-primary">Accept</button>
                                <button class="btn btn-secondary">Decline</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <dialog id="sessionModal" class="modal-dialog">
        <div class="modal-header">
            <h3>Session Details</h3>
            <span class="modal-subtitle">View complete information about this counselling session</span>
            <button class="close-btn" onclick="closeModal()">×</button>
        </div>

        <div class="modal-body">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        Student Name
                    </div>
                    <div class="info-value" id="modalStudentName">Jordan P.</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        Session Time
                    </div>
                    <div class="info-value" id="modalTime">2:00 PM</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        Email
                    </div>
                    <div class="info-value text-sm" id="modalEmail">jordan.p@university.edu</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                        Phone
                    </div>
                    <div class="info-value text-sm" id="modalPhone">(555) 234-5678</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        Session Type
                    </div>
                    <div class="info-value" id="modalType">Individual</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Status
                    </div>
                    <span class="status-badge" id="modalStatus">Confirmed</span>
                </div>
            </div>

            <div class="info-section">
                <div class="info-label">
                    <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    Reason for Session
                </div>
                <div class="info-value" id="modalReason">Academic performance concerns</div>
            </div>

            <div class="notes-section">
                <div class="info-label">
                    <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    Session Notes
                </div>
                <div class="notes-box" id="modalNotes">
                    Follow-up session to review progress on time management techniques.
                </div>
            </div>
        </div>

        <div class="modal-footer footer-grid">
            <button class="btn btn-primary btn-start">Start Session</button>
            <button class="btn btn-secondary">Reschedule</button>
            <button class="btn btn-secondary" onclick="closeModal()">Close</button>
        </div>
    </dialog>
    <script>
        function openModal(button) {
            const studentName = button.getAttribute("data-student");
            const time = button.getAttribute("data-time");
            const email = button.getAttribute("data-email");
            const phone = button.getAttribute("data-phone");
            const type = button.getAttribute("data-type");
            const status = button.getAttribute("data-status");
            const reason = button.getAttribute("data-reason");
            const notes = button.getAttribute("data-notes");

            const statusElement = document.getElementById("modalStatus");

            document.getElementById("modalStudentName").innerText = studentName;
            document.getElementById("modalTime").innerText = time;
            document.getElementById("modalEmail").innerText = email || "N/A";
            document.getElementById("modalPhone").innerText = phone || "N/A";
            document.getElementById("modalType").innerText = type;
            document.getElementById("modalReason").innerText = reason || "No specific reason provided.";
            document.getElementById("modalNotes").innerText = notes || "No notes available.";
            
            
            statusElement.innerText = status || "Confirmed";
            statusElement.className = "status-badge";
            if (status && status.toLowerCase() === 'confirmed') {
                statusElement.classList.add('confirmed');
            } else if (status && status.toLowerCase() === 'pending') {
                statusElement.classList.add('pending');
            }

            document.getElementById("sessionModal").showModal();
        }

        function closeModal() {
            document.getElementById("sessionModal").close();
        }
    </script>
</body>
</html>